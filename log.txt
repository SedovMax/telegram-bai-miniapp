[Этап 2 • 2025-11-02T18:23:12]
Сделано:
- Добавлена проверка подписи Telegram `initData` на сервере.
- Сохранение и выдача истории привязаны к Telegram `user_id`.
- Обновлены клиентские страницы для передачи `initData`.
- Добавлен индекс `bai_results_user_id_idx` в Supabase.
- Обновлён README с инструкциями по Этапу 2.

Что дальше:
- Вставить точные формулировки вопросов из PDF в `data/bai.ts` при необходимости.
- Настроить WebApp-кнопку у @BotFather (если ещё не).
- Добавить страницу политики и экспорт CSV.
[Этап 1.1 • <дата>]
Сделано:
- Репозиторий создан и опубликован на GitHub.
- Проект задеплоен на Vercel, проверка /api/health = ok.
- Supabase проект создан, таблица bai_results применена.
- Переменные окружения настроены.
- Тестирование: результаты сохраняются, график отображается.

Что дальше:
- Этап 2: связать результаты с Telegram user_id через initData.
- Добавить в WebApp проверку подписи Telegram.
- Реализовать приватное хранение и фильтрацию данных по user_id.

[Этап 1 • 2025-11-02T16:47:27]
Сделано:
- Извлечён текст вопросов из PDF и подготовлен список из 21 пунктов для теста (в файле data/bai.ts). Если автоматическое извлечение недостоверно, заменим на точные формулировки позже.
- Подготовлен каркас Next.js (app router), интеграция Telegram WebApp на клиенте, страницы: /, /test, /chart.
- Реализованы API: POST /api/save для сохранения результата, GET /api/history для выдачи истории; /api/health для проверки деплоя.
- Добавлен клиент и админ Supabase. Добавлена SQL-схема таблицы bai_results с RLS политикой только для service_role.
- Добавлены .env.example и README с шагами.

Переменные окружения:
- TELEGRAM_BOT_TOKEN
- TELEGRAM_BOT_USERNAME
- NEXT_PUBLIC_SUPABASE_URL
- NEXT_PUBLIC_SUPABASE_ANON_KEY
- SUPABASE_SERVICE_ROLE_KEY
- NEXT_PUBLIC_APP_URL

Что дальше (Этап 2):
- Проверить и утвердить точные формулировки вопросов из PDF. При необходимости я обновлю data/bai.ts дословно из файла.
- Связать записи с конкретным Telegram user_id на основе initData (включить в WebApp верификацию подписи).
- Настроить в Supabase политику доступа для чтения только своих записей, если будем использовать anon key.
- Деплой на Vercel, импорт SQL в Supabase, тест /api/health, затем кнопка web_app в боте.

Проверка:
- `GET /api/health` должен вернуть "ok".
- /test считает сумму, сохраняет. /chart строит SVG-график по истории.
